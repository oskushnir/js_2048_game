!function(){var e={};e=function(){var e;function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[[0,0,0,0],[0,0,0,0],[0,0,0,0],[0,0,0,0]];!function(e,t){if(!(e instanceof t))throw TypeError("Cannot call a class as a function")}(this,t),this.initialState=e,this.gameStatus="idle",this.score=0}return e=[{key:"moveLeft",value:function(e){var t=this;if("playing"===this.gameStatus){var r=Array.from(e),n=r.map(function(e){return Array.from(e.querySelectorAll("td")).map(function(e){return e.textContent.trim()})}),l=[];e.forEach(function(e,t){e.querySelectorAll("td").forEach(function(e,r){e.textContent.trim().length>0&&l.push({rowIndex:t,cellIndex:r,cellNumber:parseInt(e.textContent.trim(),10)})})}),this.removeCell(e),l.forEach(function(r){for(var n=r.rowIndex,l=r.cellIndex,a=r.cellNumber,o=l;o>0;){var c=e[n].querySelectorAll("td")[o-1];if(0===c.textContent.trim().length)o--;else{var i=parseInt(c.textContent);if(i===a){var u=i+a;c.textContent=u,c.className="field-cell field-cell--".concat(c.textContent),t.getScore(u),2048===u&&(t.gameStatus="win")}else{var s=e[n].querySelectorAll("td")[o];s.textContent=a,s.className="field-cell field-cell--".concat(a)}return}}var f=e[n].querySelectorAll("td")[o];f.textContent=a,f.className="field-cell field-cell--".concat(a)});var a=r.map(function(e){return Array.from(e.querySelectorAll("td")).map(function(e){return e.textContent.trim()})});if(!n.every(function(e,t){return e.every(function(e,r){return e===a[t][r]})}))return this.findEmptyCells(e)}}},{key:"moveRight",value:function(e){var t=this;if("playing"===this.gameStatus){var r=Array.from(e),n=r.map(function(e){return Array.from(e.querySelectorAll("td")).map(function(e){return e.textContent.trim()})}),l=[];e.forEach(function(e,t){for(var r=e.querySelectorAll("td"),n=r.length-1;n>=0;n--){var a=r[n];a.textContent.trim().length>0&&l.push({rowIndex:t,cellIndex:n,cellNumber:parseInt(a.textContent.trim(),10)})}}),this.removeCell(e),l.forEach(function(r){for(var n=r.rowIndex,l=r.cellIndex,a=r.cellNumber,o=l;o<e[0].querySelectorAll("td").length-1;){var c=e[n].querySelectorAll("td")[o+1];if(0===c.textContent.trim().length)o++;else{var i=parseInt(c.textContent);if(i===a){var u=i+a;c.textContent=u,c.className="field-cell field-cell--".concat(c.textContent),t.getScore(u),2048===u&&(t.gameStatus="win")}else{var s=e[n].querySelectorAll("td")[o];s.textContent=a,s.className="field-cell field-cell--".concat(a)}return}}var f=e[n].querySelectorAll("td")[o];f.textContent=a,f.className="field-cell field-cell--".concat(a)});var a=r.map(function(e){return Array.from(e.querySelectorAll("td")).map(function(e){return e.textContent.trim()})});if(!n.every(function(e,t){return e.every(function(e,r){return e===a[t][r]})}))return this.findEmptyCells(e)}}},{key:"moveUp",value:function(e){var t=this;if("playing"===this.gameStatus){var r=Array.from(e),n=r.map(function(e){return Array.from(e.querySelectorAll("td")).map(function(e){return e.textContent.trim()})}),l=[];e.forEach(function(e,t){e.querySelectorAll("td").forEach(function(e,r){e.textContent.trim().length>0&&l.push({rowIndex:t,cellIndex:r,cellNumber:parseInt(e.textContent.trim(),10)})})}),this.removeCell(e),l.forEach(function(r){for(var n=r.rowIndex,l=r.cellIndex,a=r.cellNumber,o=n;o>0;){var c=e[o-1].querySelectorAll("td")[l];if(0===c.textContent.trim().length)o--;else{var i=parseInt(c.textContent);if(i===a){var u=i+a;c.textContent=u,c.className="field-cell field-cell--".concat(c.textContent),t.getScore(u),2048===u&&(t.gameStatus="win")}else{var s=e[o].querySelectorAll("td")[l];s.textContent=a,s.className="field-cell field-cell--".concat(a)}return}}var f=e[o].querySelectorAll("td")[l];f.textContent=a,f.className="field-cell field-cell--".concat(a)});var a=r.map(function(e){return Array.from(e.querySelectorAll("td")).map(function(e){return e.textContent.trim()})});if(!n.every(function(e,t){return e.every(function(e,r){return e===a[t][r]})}))return this.findEmptyCells(e)}}},{key:"moveDown",value:function(e){var t=this;if("playing"===this.gameStatus){for(var r=function(t){e[t].querySelectorAll("td").forEach(function(e,r){e.textContent.trim().length>0&&a.push({rowIndex:t,cellIndex:r,cellNumber:parseInt(e.textContent.trim(),10)})})},n=Array.from(e),l=n.map(function(e){return Array.from(e.querySelectorAll("td")).map(function(e){return e.textContent.trim()})}),a=[],o=e.length-1;o>=0;o--)r(o);this.removeCell(e),a.forEach(function(r){for(var n=r.rowIndex,l=r.cellIndex,a=r.cellNumber,o=n;o<e.length-1;){var c=e[o+1].querySelectorAll("td")[l];if(0===c.textContent.trim().length)o++;else{var i=parseInt(c.textContent);if(i===a){var u=i+a;c.textContent=u,c.className="field-cell field-cell--".concat(c.textContent),t.getScore(u),2048===u&&(t.gameStatus="win")}else{var s=e[o].querySelectorAll("td")[l];s.textContent=a,s.className="field-cell field-cell--".concat(a)}return}}var f=e[o].querySelectorAll("td")[l];f.textContent=a,f.className="field-cell field-cell--".concat(a)});var c=n.map(function(e){return Array.from(e.querySelectorAll("td")).map(function(e){return e.textContent.trim()})});if(!l.every(function(e,t){return e.every(function(e,r){return e===c[t][r]})}))return this.findEmptyCells(e)}}},{key:"getScore",value:function(e){return void 0!==e&&(this.score+=e),this.score}},{key:"getState",value:function(e){var t=[];return e.forEach(function(e){var r=e.querySelectorAll("td"),n=[];r.forEach(function(e,t){n.push(t)}),t.push(n)}),this.initialState=t,this.initialState}},{key:"getStatus",value:function(){return this.gameStatus}},{key:"start",value:function(e){this.gameStatus="playing";var t=!0;return e.forEach(function(e){e.querySelectorAll("td").forEach(function(e){e.textContent.trim().length>0&&(t=!1)})}),this.createCell(t)}},{key:"restart",value:function(e){this.gameStatus="idle",this.score=0,this.removeCell(e),this.isGridFull=[]}},{key:"getRandomIndex",value:function(){var e=[],t=Math.floor(4*Math.random()),r=Math.floor(4*Math.random()),n=Math.floor(4*Math.random()),l=Math.floor(4*Math.random());return t===n&&(t=Math.floor(4*Math.random()),n=Math.floor(4*Math.random())),r===l&&(r=Math.floor(4*Math.random()),l=Math.floor(4*Math.random())),t===r&&(t=Math.floor(4*Math.random()),r=Math.floor(4*Math.random())),n===l&&(n=Math.floor(4*Math.random()),l=Math.floor(4*Math.random())),e.push(t),e.push(r),e.push(n),e.push(l),e}},{key:"getRandomCellNumber",value:function(){var e=Math.random(),t=[];return t.push(.1>=Math.random()?4:2),t.push(e<=.1?4:2),t}},{key:"createCell",value:function(e){var t=this.getRandomIndex(),r=this.getRandomCellNumber(),n=null,l=null,a=[];return this.initialState.forEach(function(o,c){o.forEach(function(o,i){e&&(c===t[0]&&i===t[2]&&(n={rowIndex:t[0],cellIndex:t[2],cellNumber:r[0]},a.push(n)),c===t[1]&&i===t[3]&&(l={rowIndex:t[1],cellIndex:t[3],cellNumber:r[1]},a.push(l)))})}),a}},{key:"createCellIfGameStarted",value:function(e,t){var r=Math.floor(Math.random()*e.length),n=e[r],l=t[r];e.splice(r,1),t.splice(r,1);var a=this.getRandomCellNumber(),o=null,c=[];return e.splice(r,1),t.splice(r,1),this.initialState.forEach(function(e,t){e.forEach(function(e,r){t===n&&r===l&&(o={rowIndex:t,cellIndex:r,cellNumber:a[0]},c.push(o))})}),c}},{key:"findEmptyCells",value:function(e){var t=[],r=[];return e.forEach(function(e,n){e.querySelectorAll("td").forEach(function(e,l){0===e.textContent.trim().length&&(t.push(n),r.push(l))})}),this.createCellIfGameStarted(t,r)}},{key:"isMovePossible",value:function(e){var t=[],r=[];e.forEach(function(e){if(4===e.length&&!e.includes("")&&t.length<4)for(var r=[],n=0;n<e.length-1;n++)e[n]!==e[n+1]&&r.push(!0),3===r.length&&t.push(!0)});for(var n=0;n<e.length-1;n++){var l=e[n],a=e[n+1],o=[];if(4===l.length&&4===a.length&&!l.includes("")&&!a.includes(""))for(var c=0;c<l.length;c++)l[c]!==a[c]&&o.push(!0),4===o.length&&r.push(!0)}4===t.length&&3===r.length&&(this.gameStatus="lose")}},{key:"removeCell",value:function(e){e.forEach(function(e){e.querySelectorAll("td").forEach(function(e){e.textContent.length>0&&(e.className="field-cell",e.innerHTML="")})})}},{key:"changeMessage",value:function(e){"playing"===this.gameStatus&&e.classList.add("hidden"),"idle"===this.gameStatus&&e.classList.remove("hidden")}}],function(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}(t.prototype,e),t}();var t=document.querySelector(".controls"),r=t.querySelector(".game-score"),n=t.querySelector(".button"),l=document.querySelector("table").querySelector("tbody"),a=l.querySelectorAll("tr"),o=document.querySelector(".message-container"),c=o.querySelector(".message-lose"),i=o.querySelector(".message-win"),u=o.querySelector(".message-start");c.classList.add("hidden"),i.classList.add("hidden");var s=new e;function f(e){if(void 0!==e){var t=e[0];a.forEach(function(e,r){e.querySelectorAll("td").forEach(function(e,n){t.rowIndex===r&&t.cellIndex===n&&(e.classList.add("field-cell--".concat(t.cellNumber)),e.textContent=t.cellNumber)})})}}s.getState(a),n.addEventListener("click",function(){if(n.hasAttribute("class","start")&&"Start"===n.textContent){n.classList.remove("start"),n.classList.add("restart"),n.textContent="Restart";var e=s.start(a);s.changeMessage(u),a.forEach(function(t,r){t.querySelectorAll("td").forEach(function(t,n){if(2===e.length){var l=e[0],a=e[1];l.rowIndex===r&&l.cellIndex===n&&(t.classList.add("field-cell--".concat(l.cellNumber)),t.textContent=l.cellNumber),a.rowIndex===r&&a.cellIndex===n&&(t.classList.add("field-cell--".concat(a.cellNumber)),t.textContent=a.cellNumber)}})})}else n.hasAttribute("class","restart")&&"Restart"===n.textContent&&(n.classList.remove("restart"),n.classList.add("start"),n.textContent="Start",s.restart(a),r.textContent=0,i.classList.add("hidden"),c.classList.add("hidden"),s.changeMessage(u))}),new MutationObserver(function(){var e=Array.from(a).map(function(e){return Array.from(e.querySelectorAll("td")).map(function(e){return e.textContent.trim()})});s.isMovePossible(e),"lose"===s.gameStatus&&c.classList.remove("hidden")}).observe(l,{childList:!0,subtree:!0}),document.addEventListener("keydown",function(e){if(e.preventDefault(),"playing"===s.getStatus())switch(e.key){case"ArrowLeft":f(s.moveLeft(a));break;case"ArrowRight":f(s.moveRight(a));break;case"ArrowUp":f(s.moveUp(a));break;case"ArrowDown":f(s.moveDown(a))}r.textContent=s.getScore(),"win"===s.getStatus()&&i.classList.remove("hidden")})}();
//# sourceMappingURL=index.03d8f331.js.map
